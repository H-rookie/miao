<script>
  var JOURNAL = [
    { "events": ["carrot", "exercise", "weekend"], "squirrel": false },
    { "events": ["bread", "pudding", "brushed teeth", "weekend", "touched tree"], "squirrel": false },
    { "events": ["carrot", "nachos", "brushed teeth", "cycling", "weekend"], "squirrel": false },
    { "events": ["brussel sprouts", "ice cream", "brushed teeth", "computer", "weekend"], "squirrel": false },
    { "events": ["potatoes", "candy", "brushed teeth", "exercise", "weekend", "dentist"], "squirrel": false },
    { "events": ["brussel sprouts", "pudding", "brushed teeth", "running", "weekend"], "squirrel": false },
    { "events": ["pizza", "brushed teeth", "computer", "work", "touched tree"], "squirrel": false },
    { "events": ["bread", "beer", "brushed teeth", "cycling", "work"], "squirrel": false },
    { "events": ["cauliflower", "brushed teeth", "work"], "squirrel": false },
    { "events": ["pizza", "brushed teeth", "cycling", "work"], "squirrel": false },
    { "events": ["lasagna", "nachos", "brushed teeth", "work"], "squirrel": false },
    { "events": ["brushed teeth", "weekend", "touched tree"], "squirrel": false },
    { "events": ["lettuce", "brushed teeth", "television", "weekend"], "squirrel": false },
    { "events": ["spaghetti", "brushed teeth", "work"], "squirrel": false },
    { "events": ["brushed teeth", "computer", "work"], "squirrel": false },
    { "events": ["lettuce", "nachos", "brushed teeth", "work"], "squirrel": false },
    { "events": ["carrot", "brushed teeth", "running", "work"], "squirrel": false },
    { "events": ["brushed teeth", "work"], "squirrel": false },
    { "events": ["cauliflower", "reading", "weekend"], "squirrel": false },
    { "events": ["bread", "brushed teeth", "weekend"], "squirrel": false },
    { "events": ["lasagna", "brushed teeth", "exercise", "work"], "squirrel": false },
    { "events": ["spaghetti", "brushed teeth", "reading", "work"], "squirrel": false },
    { "events": ["carrot", "ice cream", "brushed teeth", "television", "work"], "squirrel": false },
    { "events": ["spaghetti", "nachos", "work"], "squirrel": false },
    { "events": ["cauliflower", "ice cream", "brushed teeth", "cycling", "work"], "squirrel": false },
    { "events": ["spaghetti", "peanuts", "computer", "weekend"], "squirrel": true },
    { "events": ["potatoes", "ice cream", "brushed teeth", "computer", "weekend"], "squirrel": false },
    { "events": ["potatoes", "ice cream", "brushed teeth", "work"], "squirrel": false },
    { "events": ["peanuts", "brushed teeth", "running", "work"], "squirrel": false },
    { "events": ["potatoes", "exercise", "work"], "squirrel": false },
    { "events": ["pizza", "ice cream", "computer", "work"], "squirrel": false },
    { "events": ["lasagna", "ice cream", "work"], "squirrel": false },
    { "events": ["cauliflower", "candy", "reading", "weekend"], "squirrel": false },
    { "events": ["lasagna", "nachos", "brushed teeth", "running", "weekend"], "squirrel": false },
    { "events": ["potatoes", "brushed teeth", "work"], "squirrel": false },
    { "events": ["carrot", "work"], "squirrel": false },
    { "events": ["pizza", "beer", "work", "dentist"], "squirrel": false },
    { "events": ["lasagna", "pudding", "cycling", "work"], "squirrel": false },
    { "events": ["spaghetti", "brushed teeth", "reading", "work"], "squirrel": false },
    { "events": ["spaghetti", "pudding", "television", "weekend"], "squirrel": false },
    { "events": ["bread", "brushed teeth", "exercise", "weekend"], "squirrel": false },
    { "events": ["lasagna", "peanuts", "work"], "squirrel": true },
    { "events": ["pizza", "work"], "squirrel": false },
    { "events": ["potatoes", "exercise", "work"], "squirrel": false },
    { "events": ["brushed teeth", "exercise", "work"], "squirrel": false },
    { "events": ["spaghetti", "brushed teeth", "television", "work"], "squirrel": false },
    { "events": ["pizza", "cycling", "weekend"], "squirrel": false },
    { "events": ["carrot", "brushed teeth", "weekend"], "squirrel": false },
    { "events": ["carrot", "beer", "brushed teeth", "work"], "squirrel": false },
    { "events": ["pizza", "peanuts", "candy", "work"], "squirrel": true },
    { "events": ["carrot", "peanuts", "brushed teeth", "reading", "work"], "squirrel": false },
    { "events": ["potatoes", "peanuts", "brushed teeth", "work"], "squirrel": false },
    { "events": ["carrot", "nachos", "brushed teeth", "exercise", "work"], "squirrel": false },
    { "events": ["pizza", "peanuts", "brushed teeth", "television", "weekend"], "squirrel": false },
    { "events": ["lasagna", "brushed teeth", "cycling", "weekend"], "squirrel": false },
    { "events": ["cauliflower", "peanuts", "brushed teeth", "computer", "work", "touched tree"], "squirrel": false },
    { "events": ["lettuce", "brushed teeth", "television", "work"], "squirrel": false },
    { "events": ["potatoes", "brushed teeth", "computer", "work"], "squirrel": false },
    { "events": ["bread", "candy", "work"], "squirrel": false },
    { "events": ["potatoes", "nachos", "work"], "squirrel": false },
    { "events": ["carrot", "pudding", "brushed teeth", "weekend"], "squirrel": false },
    { "events": ["carrot", "brushed teeth", "exercise", "weekend", "touched tree"], "squirrel": false },


    { "events": ["brussel sprouts", "running", "work"], "squirrel": false },
    { "events": ["brushed teeth", "work"], "squirrel": false },
    { "events": ["lettuce", "brushed teeth", "running", "work"], "squirrel": false },
    { "events": ["candy", "brushed teeth", "work"], "squirrel": false },
    { "events": ["brussel sprouts", "brushed teeth", "computer", "work"], "squirrel": false },
    { "events": ["bread", "brushed teeth", "weekend"], "squirrel": false },
    { "events": ["cauliflower", "brushed teeth", "weekend"], "squirrel": false },
    { "events": ["spaghetti", "candy", "television", "work", "touched tree"], "squirrel": false },
    { "events": ["carrot", "pudding", "brushed teeth", "work"], "squirrel": false },
    { "events": ["lettuce", "brushed teeth", "work"], "squirrel": false },
    { "events": ["carrot", "ice cream", "brushed teeth", "cycling", "work"], "squirrel": false },
    { "events": ["pizza", "brushed teeth", "work"], "squirrel": false },
    { "events": ["spaghetti", "peanuts", "exercise", "weekend"], "squirrel": true },
    { "events": ["bread", "beer", "computer", "weekend", "touched tree"], "squirrel": false },
    { "events": ["brushed teeth", "running", "work"], "squirrel": false },
    { "events": ["lettuce", "peanuts", "brushed teeth", "work", "touched tree"], "squirrel": false },
    { "events": ["lasagna", "brushed teeth", "television", "work"], "squirrel": false },
    { "events": ["cauliflower", "brushed teeth", "running", "work"], "squirrel": false },
    { "events": ["carrot", "brushed teeth", "running", "work"], "squirrel": false },
    { "events": ["carrot", "reading", "weekend"], "squirrel": false },
    { "events": ["carrot", "peanuts", "reading", "weekend"], "squirrel": true },
    { "events": ["potatoes", "brushed teeth", "running", "work"], "squirrel": false },
    { "events": ["lasagna", "ice cream", "work", "touched tree"], "squirrel": false },
    { "events": ["cauliflower", "peanuts", "brushed teeth", "cycling", "work"], "squirrel": false },
    { "events": ["pizza", "brushed teeth", "running", "work"], "squirrel": false },
    { "events": ["lettuce", "brushed teeth", "work"], "squirrel": false },
    { "events": ["bread", "brushed teeth", "television", "weekend"], "squirrel": false },
    { "events": ["cauliflower", "peanuts", "brushed teeth", "weekend"], "squirrel": false }
  ];

  function phi(table) {
    return (table[3] * table[0] - table[2] * table[1]) /
      Math.sqrt((table[2] + table[3]) *
        (table[0] + table[1]) *
        (table[1] + table[3]) *
        (table[0] + table[2]));
  }

  function tableFor(event, journal) {
    var table = [0, 0, 0, 0]
    for (var i = 0; i < journal.length; i++) {
      var entry = journal[i]
      var index = 0  //00用下标代表事件有没有发生和变没变松鼠

      if (entry.events.includes(event)) {
        index++ //低位1代表事件发生了
      }

      if (entry.squirrel) {
        index += 2 //高位1代表变松鼠了
      }

      table[index]++
    }

    return table
  }

  /*   var phis = {}

    for (var i = 0; i < JOURNAL.length; i++) {
      var entry = JOURNAL[i]
      var events = entry.events

      //遍历
      for (var j = 0; j < events.length; j++) {
        var event = events[j]  //记录events里的每一个事件

        // console.log(table,p)
        if (!(event in phis)) {  //已经出现过的事件不用加入phis对象中
          var table = tableFor(event, JOURNAL)  //制作事件的表
          var p = phi(table)    //事件的相关性

          phis[event] = p  //放入对象中，会覆盖
        }
      }
    } */

  // for (var prop in phis) {
  //   console.log(prop, phis[prop])
  // }

  for (var i = 0; i < JOURNAL.length; i++) {
    var entry = JOURNAL[i]
    if ((entry.events.includes('peanuts')) && !(entry.events.includes('brushed teeth'))) {
      entry.events.push('吃了花生但没刷牙')
    }
  }

  // return phi(tableFor('吃了花生但没刷牙', JOURNAL))


  function indexOf(array, target) {
    for (var i = 0; i < array.length; i++) {
      if (array[i] === target) {
        return i
      }
    }

    return -1
  }

  function lastIndexOf(array, target) {
    for (var i = array.length - 1; i >= 0; i--) {
      if (array[i] === target) {
        return i
      }
    }

    return -1
  }

  function slice(array, start, end = array.length) {

    var arr = []
    for (var i = start; i < end; i++) {
      arr.push(array[i])
    }

    return arr
  }

  function slice(str, start, end = str.length) {

    var result = ''
    for (var i = start; i < end; i++) {
      result += str[i]
    }

    return result
  }

  function concat(array, items) {
    var result = []

    for (var i = 0; i < arguments.length; i++) {

      if (Array.isArray(arguments[i])) {
        for (var j = 0; j < arguments[i].length; j++) {
          result.push(arguments[i][j])
        }
      } else {
        result.push(arguments[j])
      }
    }

    return result
  }


  function fill(array, value, start = 0, end = array.length) {
    for (var i = start; i < end; i++) {
      array[i] = value
    }

    return array
  }


  //不用担心depth传入无穷大
  //虽然传入无穷大时随着递归进行并不会减少，但array的深度会逐层减少，最后到一维
  //就再不会进for循环内部的if了，只会进else，不再递归了
  function flat(array, depth = 1) {

    for (var k = 0; k < depth; k++) {


      var flag = 0 //记录这次是不是只有一维数组了
      //从这
      var result = []
      for (var i = 0; i < array.length; i++) {
        var item = array[i]

        if (Array.isArray(item)) {
          flag = 1
          for (var j = 0; j < item.length; j++) {
            result.push(item[j])
          }
          //到这，会把array降低一个维度
        } else {
          result.push(array[i])
        }

      }

      if(!flag) {
        return result
      }

      array = result  //把新的数组赋值给array
    }

    return result
  }


  //depth是infinity也行，因为展开最后一定只剩一维数组，会返回该数组
  function flat(array, depth = 1) {

    if (depth == 0) {
      return array.slice()
    }

    var result = []
    for (var i = 0; i < array.length; i++) {
      var item = array[i]

      if (Array.isArray(item)) {

        var flattedItem = flat(item, depth - 1)
        for (var j = 0; j < flattedItem.length; j++) {
          result.push(flattedItem[j])
        }

      } else {
        result.push(item)
      }
    }

    return result
  }


  function includes(array, value) {
    if (value !== value) {  //判断value是不是NaN
      for (var i = 0; i < array.length; i++) {
        if (array[i] !== array[i]) {  //判断里面有没有NaN这个数
          return true
        }
      }

      return false
    } else {
      for (var i = 0; i < array.length; i++) {
        if (array[i] === value) {
          return true
        }
      }
      return false
    }
  }

  function reverse(array) {
    var newArray = []

    for (var i = 0; i < array.length; i++) {
      newArray.push(array[array.length - i - 1])
    }

    return newArray
  }

  function reverse(array) {

    var end = Math.floor(array.length / 2)
    for (var i = 0; i < end; i++) {
      var j = array.length - i - 1
      var t = array[j]
      array[j] = array[i]
      array[i] = t
    }

    return array
  }


  function max() {
    var max = 0
    for (var i = 0; i < arguments.length; i++) {
      if (arguments[i] > max) {
        max = arguments[i]
      }
    }

    return max
  }

  var a = 89292918
  function random() {
    a = a * a
    var num = String(a)
    var str = num.slice(3, 8)
    return str
  }


  function copyWithin(arr, target, start, end) {

    if (target === start) {
      return arr
    }

    if (target < start) {
      for (var i = start; i < end && i < arr.length; i++) {
        arr[target] = arr[i]
        target++
      }
    }

    if (target > start) {
      var target = target + end - start - 1
      for (var i = end - 1; i >= start && i >= 0; i--) {
        arr[target] = arr[i]
        target--
      }
    }

    return arr
  }

  function bubbleSort(ary) {

    for (var stop = ary.length - 1; stop < ary.length; stop--) {

      for (var i = 0; i < stop; i++) {

        if (ary[i] > ary[i + 1]) {
          var t = ary[i]
          ary[i] = ary[i + 1]
          ary[i + 1] = t
        }
      }
      length--
    }
  }

  function isSorted(ary) {
    for (var i = 0; i < ary.length; i++) {
      if (ary[i] > ary[i + 1]) {
        return false
      }
    }

    return true
  }

  function randomArray(n) {

  }

  function selectSort(array) {
    for (var i = 0; i < array.length - 1; i++) {

      var minIndex = i
      for (var j = i + 1; j < array.length; j++) {
        if (array[j] < array[minIndex]) {
          minIndex = j
        }
      }

      var t = array[i]
      array[i] = array[minIndex]
      array[minIndex] = t
    }
  }

  function insertSort(array) {
    for (var i = 1; i < array.length; i++) {

      var now = array[i]
      for (var j = i - 1; j >= 0; j--) {
        if (now < array[j]) {
          array[j + 1] = array[j]
        } else {
          array[j + 1] = now
        }
      }
    }
    return array
  }

  function quickSort(array) {
    var num = array[0]

    var low = []
    var same = []
    var high = []
    for (var i = 0; i < array.length; i++) {
      var number = array[i]
      if (number < num) {
        low.push(number)
      } else if (number > num) {
        high.push(number)
      } else {
        same.push(number)
      }
    }

    quickSort(low)
    quickSort(high)


  }
</script>
